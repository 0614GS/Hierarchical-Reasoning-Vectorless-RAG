# ğŸš€ Hierarchical Reasoning RAG (Vectorless)

> ä¸€ä¸ªåŸºäºæ–‡æ¡£å±‚çº§ç»“æ„ï¼ˆHierarchical Treeï¼‰å’Œ LLM æ¨ç†çš„æ£€ç´¢å¢å¼ºç”Ÿæˆç³»ç»Ÿã€‚å‘Šåˆ«ä¼ ç»Ÿ Embedding çš„â€œè¯­ä¹‰æ¨¡ç³Šâ€é—®é¢˜ï¼Œå®ç°æå…¶ç²¾å‡†çš„å·¥ä¸šçº§æ–‡æ¡£æ£€ç´¢ã€‚

---

## ğŸ’¡ æ ¸å¿ƒè®¾è®¡å“²å­¦ (The Core Philosophy)

æœ¬é¡¹ç›®æ‘’å¼ƒäº†ä¼ ç»Ÿçš„â€œåˆ‡ç‰‡ -> å‘é‡åŒ– -> ç›¸ä¼¼åº¦åŒ¹é…â€æµç¨‹ï¼Œé‡‡ç”¨ **Tree-based Reasoning** è·¯å¾„ï¼š

* **Structure-Aware Indexing**: è‡ªåŠ¨è§£æ Markdown çš„ H1-H6 å±‚çº§ï¼Œä¿ç•™æ–‡æ¡£çš„è¡€ç»Ÿå’Œé€»è¾‘å…³è”ã€‚
* **Bottom-Up Synthesis**: èŠ‚ç‚¹æ‘˜è¦è‡ªåº•å‘ä¸Šæ±‡èšã€‚å­èŠ‚ç‚¹çš„å…³é”®è¯æ”¯æ’‘çˆ¶èŠ‚ç‚¹ï¼Œçˆ¶èŠ‚ç‚¹çš„æ‘˜è¦æµ“ç¼©å­èŠ‚ç‚¹ï¼Œå½¢æˆâ€œå…¨æ–¹ä½ã€å¤šç»´åº¦â€çš„å¯¼èˆªæ ‘ã€‚
* **Global-to-Local Routing**: 
    1. é€šè¿‡ `global_index.json` ç¡®å®šæ–‡æ¡£èŒƒå›´ã€‚
    2. é€šè¿‡ç²¾ç®€çš„ `doc_nav_tree` å¯¼èˆªåˆ°å…·ä½“çš„ `node_id`ã€‚
    3. ä» `node_content_store` æå–åŸå­çº§æ­£æ–‡ç”Ÿæˆå›ç­”ã€‚

---

## ğŸ› ï¸ æŠ€æœ¯ç‰¹æ€§ (Key Features)

- [x] **Markdown ç»“æ„åŒ–è§£æ**: è‡ªåŠ¨æ„å»º Tree ç»“æ„ï¼Œæ”¯æŒä»£ç å—è¿‡æ»¤ï¼Œé˜²æ­¢å†…å®¹å¹²æ‰°ã€‚
- [x] **åŒå±‚ç´¢å¼•æœºåˆ¶**:
    - **Global Index**: è·¨æ–‡æ¡£å¯¼èˆªï¼Œå¿«é€Ÿå®šä½ç›¸å…³æ–‡ä»¶ã€‚
    - **Local Nav Tree**: æ–‡æ¡£å†…å¯¼èˆªï¼ŒLLM åƒè¯»ç›®å½•ä¸€æ ·ç²¾å‡†å®šä½ç« èŠ‚ã€‚
- [x] **åŸå­çº§å­˜å‚¨ (Content Store)**: å¯¼èˆªæ ‘ä¸æ­£æ–‡å†…å®¹è§£è€¦ï¼Œç´¢å¼•æå…¶è½»é‡ï¼ˆToken æ¶ˆè€—é™ä½ 80%ï¼‰ã€‚
- [x] **Pydantic å¼ºåˆ¶ Schema**: æ‰€æœ‰ LLM è¾“å‡ºå‡ç»è¿‡æ ¼å¼éªŒè¯ï¼Œç¡®ä¿ Summary ä¸ Keywords çš„ç¨³å®šæ€§ã€‚
- [x] **é«˜æ€§èƒ½å¹¶å‘å¤„ç†**: é‡‡ç”¨å¼‚æ­¥ IO (`asyncio.gather`) å®ç°å¤šæ–‡æ¡£ã€å¤šèŠ‚ç‚¹çš„å¹¶è¡Œç´¢å¼•æ„å»ºã€‚

---

## ğŸ“‚ é¡¹ç›®ç»“æ„ (Project Structure)

```text
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ input/              # åŸå§‹ Markdown æ–‡æ¡£
â”‚   â”œâ”€â”€ node_content_store/ # åŸå­æ­£æ–‡å­˜å‚¨ (node_id -> text)
â”‚   â””â”€â”€ tree_results/       # æ–‡æ¡£å¯¼èˆªæ ‘ç´¢å¼• (doc_id.json)
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ md2tree.py          # æ ¸å¿ƒ: Markdown è§£æä¸æ ‘æ„å»ºé€»è¾‘
â”‚   â”œâ”€â”€ nodes.py            # LangGraph èŠ‚ç‚¹å¤„ç†é€»è¾‘
â”‚   â””â”€â”€ storage.py          # åŸºäº Key-Value çš„å­˜å‚¨å®ç°
â”œâ”€â”€ global_index.json       # å…¨å±€é¡¶çº§ç´¢å¼• (doc_id, summary, keywords)
â””â”€â”€ README.md
