{"node_id": "fb7920", "title": "Short-term vs. long-term filesystem", "path": "middleware > Deep Agents Middleware > Filesystem middleware > Short-term vs. long-term filesystem", "content": "By default, these tools write to a local \"filesystem\" in your graph state. To enable persistent storage across threads, configure a `CompositeBackend` that routes specific paths (like `/memories/`) to a `StoreBackend`.\n\n```python  theme={null}\nfrom langchain.agents import create_agent\nfrom deepagents.middleware import FilesystemMiddleware\nfrom deepagents.backends import CompositeBackend, StateBackend, StoreBackend\nfrom langgraph.store.memory import InMemoryStore\n\nstore = InMemoryStore()\n\nagent = create_agent(\n    model=\"claude-sonnet-4-5-20250929\",\n    store=store,\n    middleware=[\n        FilesystemMiddleware(\n            backend=lambda rt: CompositeBackend(\n                default=StateBackend(rt),\n                routes={\"/memories/\": StoreBackend(rt)}\n            ),\n            custom_tool_descriptions={\n                \"ls\": \"Use the ls tool when...\",\n                \"read_file\": \"Use the read_file tool to...\"\n            }  # Optional: Custom descriptions for filesystem tools\n        ),\n    ],\n)\n```\n\nWhen you configure a `CompositeBackend` with a `StoreBackend` for `/memories/`, any files prefixed with **/memories/** are saved to persistent storage and survive across different threads. Files without this prefix remain in ephemeral state storage.", "summary": "Describes how to configure a CompositeBackend for persistent storage of specific paths in the filesystem middleware.", "keywords": ["CompositeBackend", "StoreBackend", "StateBackend", "InMemoryStore", "FilesystemMiddleware", "persistent storage", "ephemeral state storage", "Deep Agents Middleware"]}