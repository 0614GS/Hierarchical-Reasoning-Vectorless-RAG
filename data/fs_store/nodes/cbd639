{"node_id": "cbd639", "title": "CompositeBackend (router)", "path": "backends > Backends > Built-in backends > CompositeBackend (router)", "content": "```python  theme={null}\nfrom deepagents import create_deep_agent\nfrom deepagents.backends import CompositeBackend, StateBackend, StoreBackend\nfrom langgraph.store.memory import InMemoryStore\n\ncomposite_backend = lambda rt: CompositeBackend(\n    default=StateBackend(rt),\n    routes={\n        \"/memories/\": StoreBackend(rt),\n    }\n)\n\nagent = create_deep_agent(\n    backend=composite_backend,\n    store=InMemoryStore()  # Store passed to create_deep_agent, not backend\n)\n```\n\n**How it works:**\n\n* Routes file operations to different backends based on path prefix.\n* Preserves the original path prefixes in listings and search results.\n\n**Best for:**\n\n* When you want to give your agent both ephemeral and cross-thread storage, a CompositeBackend allows you provide both a StateBackend and StoreBackend\n* When you have multiple sources of information that you want to provide to your agent as part of a single filesystem.\n  * e.g. You have long-term memories stored under /memories/ in one Store and you also have a custom backend that has documentation accessible at /docs/.", "summary": "Describes the CompositeBackend router, which routes file operations to different backends based on path prefixes, suitable for combining multiple storage types.", "keywords": ["CompositeBackend", "router", "StateBackend", "StoreBackend", "path prefixes", "file operations", "InMemoryStore", "deepagents", "create_deep_agent"]}